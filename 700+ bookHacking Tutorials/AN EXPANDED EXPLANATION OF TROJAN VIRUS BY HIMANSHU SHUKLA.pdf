%PDF-1.3
1 0 obj
<<
/CreationDate(D:20160204102502)
/Title()
/Author(PDFZilla)
/Keywords(PDFZilla,Zilla PDF)
/Producer(PDFZilla - Zilla TXT To PDF Converter)
>>
endobj
5 0 obj
[
750 750 278 278 355 556 556 889 667 190 333 333 389 584 278 333 
278 278 556 556 556 556 556 556 556 556 556 556 278 278 584 584 
584 556 1015 667 667 722 722 667 610 778 722 278 500 667 556 832 
722 778 667 778 722 667 610 722 667 944 667 667 610 278 278 278 
469 556 333 556 556 500 556 556 278 556 556 222 222 500 222 832 
556 556 556 556 333 500 278 556 500 722 500 500 500 334 260 334 
584 750 556 750 222 556 333 1000 556 556 333 1000 667 333 1000 750 
610 750 750 222 222 333 333 350 556 1000 333 1000 500 333 944 750 
500 667 278 333 556 556 556 556 260 556 333 736 370 556 584 333 
736 552 400 549 333 333 333 576 537 333 333 333 365 556 834 834 
834 610 667 667 667 667 667 667 1000 722 667 667 667 667 278 278 
278 278 722 722 778 778 778 778 778 584 778 722 722 722 722 667 
667 610 556 556 556 556 556 556 889 500 556 556 556 556 278 278 
278 278 556 556 556 556 556 556 556 549 610 556 556 556 556 500 
556 500 
]
endobj
6 0 obj
<<
/Type/FontDescriptor
/FontName/Arial
/Ascent 905
/Descent -212
/ItalicAngle 0
/CapHeight 905
/Flags 32
/FontBBox[0 0 0 0]
>>
endobj
7 0 obj
<<
/Type/Font
/Subtype/TrueType
/Name/F0
/BaseFont/Arial
/Encoding/WinAnsiEncoding
/FirstChar 30
/LastChar 255
/Widths 5 0 R
/FontDescriptor 6 0 R
>>
endobj
8 0 obj
<<
/Length 6170
>>
stream
BT
/F0 10 Tf
0 0 0 rg
28.346 804.491 Td
(þÿBATCH FILE COMMANDS) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 790.318 Td
(Simple programming commands in a batch environment) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 776.144 Td
(--------------------------------------------------------------------------------------------------------------) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 761.971 Td
(----------------------------------------------------------------------------------------------------) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 747.798 Td
( ///////////*1000+ HACKING TRICKS & TUTORIALS - ebook By Mukesh Bhardwaj Blogger  - Paid Version - only @ ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 733.625 Td
(TekGyd | itechhacks | Mukeshtricks4u*///////) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 719.451 Td
(--------------------------------------------------------------------------------------------------------------) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 705.278 Td
(----------------------------------------------------------------------------------------------------) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 691.105 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 676.932 Td
(Yeah, yeah, I know that many people think batch files are mostly things of the past. Sometimes, though, a ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 662.759 Td
(well-conceived batch file is just the thing to automate the job you want to do.) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 648.585 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 634.412 Td
(I am not going to cover all the theory and practice of batch files from the ground up. Any good book on DOS ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 620.239 Td
(\(now found in the Antiquities section of your local library <g>\), and many of the best on Windows, will have a) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 606.066 Td
(section on batch files. Simply put, a batch file is a plaintext file with a name ending in .BAT. In its ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 591.892 Td
(simplest form, it contains a series of commands that could be executed from a command prompt \(system prompt\). ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 577.719 Td
(The batch file simply autoexecutes them for you. \(In fact, AUTOEXEC.BAT is the best known, and most widely ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 563.546 Td
(used, batch file.\) To execute a batch file, type its name at a command prompt, or execute a Windows shortcut ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 549.373 Td
(that does the same thing.) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 535.199 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 521.026 Td
(The simplest idea of how to write a batch file is: Figure out how you would type the commands at a DOS prompt,) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 506.853 Td
(then type them, one per line, in a text file   and you ve written your batch file.) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 492.68 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 478.507 Td
(However, there are also more sophisticated batch file structures, using simple programming commands built into) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 464.333 Td
(the batch structure. This article summarizes the most important of these.) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 450.16 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 435.987 Td
(Commandline Arguements {%x}) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 421.814 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 407.64 Td
(Variables can be inserted into a batch structure in the form of command line arguements. These are in the form) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 393.467 Td
(%1, %2, etc. To populate the variables, type the desired values after the batch file name when executing it.) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 379.294 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 365.121 Td
(DOS Environment Variable Names {%nn%}) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 350.948 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 336.774 Td
(DOS environment variables also can be used as variables in batch files. For example:) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 322.601 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 308.428 Td
(COPY %windir%\\filename a:) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 294.255 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 280.081 Td
(Where does one get a list of DOS environment variables? I have never found a comprehensive list; but a partial) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 265.908 Td
(but lengthy list of existing environment variables can be gotten by typing SET at a command prompt.) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 251.735 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 237.562 Td
(And here s the really cool part! You can make them up as you go along, and assign them as you wish \(as long ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 223.388 Td
(as you don t grab one that has a legitimate assigned value, such as, say, %windir%, the Windows directory ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 209.215 Td
(name!\). Pick a name, populate it with the SET command by any means known to you \(including having one batch ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 195.042 Td
(file run a process that includes setting one, and then another batch file using it\), then use it by placing ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 180.869 Td
(the name between flanking % signs. Environment variables remain until overwritten, or until a reboot. \(If you ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 166.696 Td
(set them in a DOS window, they will end when that session is closed.\)) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 152.522 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 138.349 Td
(If you precede an environment variable setting with the SETLOCAL command \(on a line of its own\), then ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 124.176 Td
(environment variable changes are local to the batch file. They do not exist for any other process and they do ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 110.003 Td
(not survive the completion of the batch file s execution. You can turn this setting off by issuing an ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 95.829 Td
(ENDLOCAL command later in the batch file.) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 81.656 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 67.483 Td
(Silly example: To change the current logged drive to D:, do the following:) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 53.31 Td
() Tj
ET
endstream
endobj
9 0 obj
<<
/Type/Page
/Parent 2 0 R
/MediaBox[ 0 0 595.276 841.89 ]
/Contents 8 0 R
>>
endobj
10 0 obj
<<
/Length 5167
>>
stream
BT
/F0 10 Tf
0 0 0 rg
28.346 804.491 Td
(SET GONEXT=D:) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 790.318 Td
(%GONEXT%) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 776.144 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 761.971 Td
(More practical example: You want to copy a file to the desktop of each user the next time they log into ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 747.798 Td
(Windows. Each user logs into a different user profile, and the Desktop folder is in a unique location for each) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 733.625 Td
(user. \(The folder name will, of course, vary on non-English versions of Windows.\) For a file called ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 719.451 Td
(MYFILE.TXT, you can do this as follows on Windows 2000 or XP computers by using an environment variable ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 705.278 Td
(%userprofile% which gives the path to the root of a given user s profile:) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 691.105 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 676.932 Td
(COPY MYFILE.TXT %userprofile%\\Desktop) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 662.759 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 648.585 Td
(START Command) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 634.412 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 620.239 Td
(The START command can launch a Windows program either by specifying the program name \(and its command-line ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 606.066 Td
(parameters\), or by specifying a data file name that is associated with a particular program \(one that would ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 591.892 Td
(automatically launch if you clicked on it in Windows\).) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 577.719 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 563.546 Td
(For example, if you have NOTEPAD.EXE associated with all TXT files, then you could open the file SOME.TXT in ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 549.373 Td
(any of the following four ways:) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 535.199 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 521.026 Td
(NOTEPAD SOME.TXT) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 506.853 Td
(SOME.TXT) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 492.68 Td
(START NOTEPAD.EXE SOME.TXT) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 478.507 Td
(START SOME.TXT) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 464.333 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 450.16 Td
(Why use one or the other? Well, sometimes you may have to use one particular form to get a result   ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 435.987 Td
(depending, for example, on how the particular program is coded. Though the first form usually will work, you ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 421.814 Td
(may want, for example, to write a more general batch file to open any particular program and associated file  ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 407.64 Td
( without knowing what the requirements of all such files might be. You could, then, write a general batch ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 393.467 Td
(file line such as START %1% %2%.) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 379.294 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 365.121 Td
(One particular use of the START command is to launch the default browser and go directly to a URL, for ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 350.948 Td
(example: START http://google.com) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 336.774 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 322.601 Td
(You may use any of four command line parameters with the START command. These go after the word START, but ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 308.428 Td
(before the program name:) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 294.255 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 280.081 Td
(/minimized or /m) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 265.908 Td
(/maximized or /max) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 251.735 Td
(/restored or /r) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 237.562 Td
(/wait or /w) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 223.388 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 209.215 Td
(The first three determine the screen status in which the program opens. The last one forces the batch file to ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 195.042 Td
(halt processing until the called program has finished executing. \(This can be useful, for example, if you are ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 180.869 Td
(loading multiple items in your windows Startup folder, and the nature of the programs require that one be ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 166.696 Td
(finished before the next starts loading. Put them all in a single batch file, using the /wait parameter, and ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 152.522 Td
(only put a shortcut to the batch file in the Startup folder.\) Command line parameters of the START command can) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 138.349 Td
(be combined in a single line. Example:) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 124.176 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 110.003 Td
(START /max /wait NOTEPAD.EXE SOME.TXT) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 95.829 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 81.656 Td
(IF and IF NOT Commands) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 67.483 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 53.31 Td
(There are three variations of the IF and IF NOT commands.) Tj
ET
endstream
endobj
11 0 obj
<<
/Type/Page
/Parent 2 0 R
/MediaBox[ 0 0 595.276 841.89 ]
/Contents 10 0 R
>>
endobj
12 0 obj
<<
/Length 4952
>>
stream
BT
/F0 10 Tf
0 0 0 rg
28.346 804.491 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 790.318 Td
(    IF EXIST: Execute the commandline only if a particular file exists:) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 776.144 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 761.971 Td
(    IF EXIST some.txt COPY c:\\some.dll %windir%\\SYSTEM\\some.dll) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 747.798 Td
(    Compare two text strings, and execute the commandline only if they are identical.) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 733.625 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 719.451 Td
(    IF %HostWinBootDrv%==C SET WinDir=C:\\WINDOWS) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 705.278 Td
(    Error testing: Check the exit code of the most recently run program. If it is equal to or greater than the) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 691.105 Td
(number specified, execute the command:) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 676.932 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 662.759 Td
(    IF ERRORLEVEL 4 ERASE trashfile.tmp /P) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 648.585 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 634.412 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 620.239 Td
(GOTO Command) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 606.066 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 591.892 Td
(You can set a label in a batch file by beginning a line with a colon. You can then go directly to that label ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 577.719 Td
(with the GOTO command. The GOTO command searches both forward and backward in the batch file; that is, it ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 563.546 Td
(simply goes to the label location, regardless of where it is in the file.) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 549.373 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 535.199 Td
(For example, in my batch file for removing the Happy99 virus, UNHAPPY.BAT, the following code was used to make) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 521.026 Td
(sure a file was not deleted unless the original form of it \(backed up by the virus under the name WSOCK32.SKA\)) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 506.853 Td
(is present:) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 492.68 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 478.507 Td
(IF NOT EXIST WSOCK32.SKA GOTO SavedIt) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 464.333 Td
(DEL WSOCK32.DLL) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 450.16 Td
(RENAME WSOCK32.SKA WSOCK32.DLL) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 435.987 Td
(:SavedIt) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 421.814 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 407.64 Td
(FOR Command) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 393.467 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 379.294 Td
(The syntax for this command is: FOR variable in \(set list\) DO command) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 365.121 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 350.948 Td
(The variable must be in the form of one alphabetic character preceeded by %%; e.g., %%v.) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 336.774 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 322.601 Td
(    NOTE: The %% is necessary because this is in a batch file which, otherwise, would give a special meaning ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 308.428 Td
(to a single %. However, if you run the FOR command outside of a batch file, simply from the system prompt, ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 294.255 Td
(just use a single % in the variable name. \(Tip from Steve Wisdom\)) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 280.081 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 265.908 Td
(The set list is enclosed within parentheses. These values will be assigned to the variable successively. You ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 251.735 Td
(can use any text enclosed in quotes, batch file commandline parameters, environment variables, or DOS file ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 237.562 Td
(wildcard expressions.) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 223.388 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 209.215 Td
(The command can be any valid command that otherwise could be entered into the batch file as a line of its own.) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 195.042 Td
(example:) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 180.869 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 166.696 Td
(FOR %%D in \(SYSTEM, COMMAND, SHELLNEW, "Start Menu"\) DO DIR "%windir%\\%%D" /W) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 152.522 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 138.349 Td
(Menu Creation) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 124.176 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 110.003 Td
(Sometimes you may want to let a batch file branch one way or another based on user input. This is especially ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 95.829 Td
(helpful when you have several related batch processes and would like to combine them into a single ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 81.656 Td
(application.) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 67.483 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 53.31 Td
(Back in DOS days, a common approach was to construct menus with multiple batch files. For example, you could ) Tj
ET
endstream
endobj
13 0 obj
<<
/Type/Page
/Parent 2 0 R
/MediaBox[ 0 0 595.276 841.89 ]
/Contents 12 0 R
>>
endobj
14 0 obj
<<
/Length 5895
>>
stream
BT
/F0 10 Tf
0 0 0 rg
28.346 804.491 Td
(create one batch file called MENU.BAT that displayed the menu \(a series of text lines\), inviting a user to ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 790.318 Td
(type a 1, 2, 3, etc. \(or A, B, C, etc.\) to choose an option \(a program to run, or archiving process, or ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 776.144 Td
(whatever\). That menu batch file would end, delivering the user back to a command prompt. You would then have a) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 761.971 Td
(series of other batch files called 1.BAT, 2.BAT, 3.BAT, etc. so that, when the user typed \(for example\) 2 and ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 747.798 Td
(pressed Enter, it would run 2.BAT. \(This is way easier to understand if you walk through making one! It s ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 733.625 Td
(really terribly simple.\)) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 719.451 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 705.278 Td
(Today, when users don t live in a DOS command prompt world, we want something slightly more sophisticated   ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 691.105 Td
(and, fortunately, we have it. There is a pretty cool way to allow user input in Windows 2000 and XP, and even ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 676.932 Td
(better ways that work in Windows Vista.) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 662.759 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 648.585 Td
(In Windows 2000 or XP, the SET command has new /A and /P flags that allow user input. The latter is especially) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 634.412 Td
(helpful for our present purposes. You can accept user input and assign it to a system variable with the ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 620.239 Td
(following code:) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 606.066 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 591.892 Td
(SET /P variable=PromptString) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 577.719 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 563.546 Td
(The PromptString is optional. If you include one, it will be displayed on the screen. \(Don") Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 549.373 Td
(t forget a space at the end of the prompt if you want one!\) For example,) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 535.199 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 521.026 Td
(SET /P M=Type 1 or 2, then press ENTER.) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 506.853 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 492.68 Td
(will display on the monitor the phrase  Type 1 or 2, then press ENTER.  It will then wait for the user to ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 478.507 Td
(type something and press Enter. It will then assign whatever character the user types to the system variable ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 464.333 Td
(%M%, which you can use in other batch file commands.) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 450.16 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 435.987 Td
(Windows Vista has added the CHOICE command. This is pretty cool! It lets you build simple menus just from this) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 421.814 Td
(one command. On a Windows Vista computer, open a command prompt and type CHOICE /? to see all the things you ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 407.64 Td
(can do with it. At the present, this might not be so useful if yo uare writing batch files that also will be ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 393.467 Td
(run on Windows XP computers, because the CHOICE command will not work on those computers   and the SET /P ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 379.294 Td
(approach above still works in Vista.) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 365.121 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 350.948 Td
(Here is an example of a batch file I recently wrote for my office. It uses many of the features discussed on ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 336.774 Td
(this page, including menu creation. The problem to be solved was that \(for reasons too tedious for the present) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 322.601 Td
(article\) users accessing our network remotely no longer had access to their browser Favorites. Additionally, ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 308.428 Td
(it was useful \(when swapping out computers\) to migrate a user s Favorites from the old computer to the new. ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 294.255 Td
(Both of these could be solved by moving the Favorites \(which are simply shortcut files\) up onto a personal ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 280.081 Td
(network drive \(let s call it P:\) to which they always had access. I wanted to allow the user, with a single ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 265.908 Td
(file that I could email them, to be able both to cache their Favorites on the network drive and to pull these ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 251.735 Td
(back down to another computer. Here is a slightly edited version of the batch file.) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 237.562 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 223.388 Td
(ECHO OFF) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 209.215 Td
(CLS) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 195.042 Td
(:MENU) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 180.869 Td
(ECHO.) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 166.696 Td
(ECHO ...............................................) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 152.522 Td
(ECHO PRESS 1 or 2 to select your task, or 3 to EXIT.) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 138.349 Td
(ECHO ...............................................) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 124.176 Td
(ECHO.) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 110.003 Td
(ECHO 1 - Export Favorites from COMPUTER to PERSONAL DRIVE \(P:\)) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 95.829 Td
(ECHO 2 - Import Favorites from PERSONAL DRIVE \(P:\) to COMPUTER) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 81.656 Td
(ECHO 3 - EXIT) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 67.483 Td
(ECHO.) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 53.31 Td
(SET /P M=Type 1, 2, or 3, then press ENTER:) Tj
ET
endstream
endobj
15 0 obj
<<
/Type/Page
/Parent 2 0 R
/MediaBox[ 0 0 595.276 841.89 ]
/Contents 14 0 R
>>
endobj
16 0 obj
<<
/Length 4476
>>
stream
BT
/F0 10 Tf
0 0 0 rg
28.346 804.491 Td
(IF %M%==1 GOTO EXPORT) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 790.318 Td
(IF %M%==2 GOTO IMPORT) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 776.144 Td
(IF %M%==3 GOTO EOF) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 761.971 Td
(:EXPORT) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 747.798 Td
(XCOPY "%userprofile%"\\Favorites\\*.* P:\\Favorites\\ /S/Y) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 733.625 Td
(GOTO MENU) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 719.451 Td
(:IMPORT) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 705.278 Td
(XCOPY P:\\Favorites "%userprofile%"\\Favorites\\*.* /S) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 691.105 Td
(GOTO MENU) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 676.932 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 662.759 Td
(More Information on These Commands) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 648.585 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 634.412 Td
(Each of these options \(START, IF, GOTO, FOR, SET\) is an actual DOS command. At a system prompt, type the ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 620.239 Td
(command name followed by /? to get further help on these items.) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 606.066 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 591.892 Td
(Note that there may be particular capabilities that show up in one version of Windows, but not in another. For) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 577.719 Td
(example, though DOS per se may well be dead in Windows XP and Vista, the commandline functions people most ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 563.546 Td
(often associate with DOS are not dead at all! \(We just don t call them  DOS commands  anymore; we call them) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 549.373 Td
( command prompt commands.  But they re the same thing.\) In some cases, these commands have been made more ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 535.199 Td
(powerful in Windows XP. In particular, if Win XP Command Extensions are enabled, each of these four has very ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 521.026 Td
(greatly enhanced capabilities \(see Win XP Help & Support to learn about Command Extensions\). Take advantage of) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 506.853 Td
(the opportunity to explore each of them with the /? help flag.) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 492.68 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 478.507 Td
(    SOME EXAMPLES \(that don t even require Command Extensions\): START has new flags that let you set the ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 464.333 Td
(priority \(/LOW, /NORMAL, /HIGH, etc.\) of the application you are launching. IF has an ELSE option than greatly) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 450.16 Td
(expands its power, but which requires a somewhat complicated syntax sometimes \(which the /? help text covers ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 435.987 Td
(reasonably well\).) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 421.814 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 407.64 Td
(Since these START, IF, GOTO, and FOR are actual OS commands, they can be used from a system prompt just like ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 393.467 Td
(DIR, COPY, or any other DOS command. This means that they can be used outside of a batch file as well. There ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 379.294 Td
(are small differences or issues that you can easily discover in use, and discussion of which would go beyond ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 365.121 Td
(the purpose of the present page. For anyone comfortable working at a DOS system prompt, this should present no) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 350.948 Td
(significant problem. Just remember:) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 336.774 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 322.601 Td
(--------------------------------------------------------------------------------------------------------------) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 308.428 Td
(----------------------------------------------------------------------------------------------------) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 294.255 Td
( ///////////*1000+ HACKING TRICKS & TUTORIALS - ebook By Mukesh Bhardwaj Blogger  - Paid Version - only @ ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 280.081 Td
(TekGyd | itechhacks | Mukeshtricks4u*///////) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 265.908 Td
(--------------------------------------------------------------------------------------------------------------) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 251.735 Td
(----------------------------------------------------------------------------------------------------) Tj
ET
endstream
endobj
17 0 obj
<<
/Type/Page
/Parent 2 0 R
/MediaBox[ 0 0 595.276 841.89 ]
/Contents 16 0 R
>>
endobj
18 0 obj
<<
/Type/Catalog
/Pages 2 0 R
>>
endobj
2 0 obj
<<
/Type/Pages
/Kids[
9 0 R
11 0 R
13 0 R
15 0 R
17 0 R
]
/Count 5
/Resources 3 0 R
>>
endobj
3 0 obj
<<
/ProcSet[/PDF/Text/ImageC]
/Font<<
/F0 7 0 R
>>
>>
endobj
xref
0 19
0000000000 65535 f
0000000009 00000 n
0000028867 00000 n
0000028969 00000 n
0000000168 00000 n
0000000168 00000 n
0000001113 00000 n
0000001256 00000 n
0000001421 00000 n
0000007642 00000 n
0000007736 00000 n
0000012955 00000 n
0000013051 00000 n
0000018055 00000 n
0000018151 00000 n
0000024098 00000 n
0000024194 00000 n
0000028722 00000 n
0000028818 00000 n
trailer
<<
/Size 19
/Root 18 0 R
/Info 1 0 R
/ID[(424044341ttNXNDXATNFRAVUBHAHSKf)(424044341ttNXNDXATNFRAVUBHAHSKf)]
>>
startxref
29038
%%EOF
